# netwhat

## Protocol Layering
- Protocol 통신 과정에서 메시지의 Delivery (송/수신) 가 발생하면, 해당 프로토콜은 Delivery 외의 일을 하위 프로토콜로 넘겨버린다
- 이때 하위 프로토콜에서 해야 할 일을 또 하위 프로토콜에 위임하는... 재귀적인 관계 (Recursive relationship) 이 발생하는데, 이것을 Protocol stack / Protocol Layering이라 부름
- 프로토콜 레이어링의 장점
	- 각 Protocol간 상호 독립적인 기능만 둘 수 있음 (프로토콜 각각의 독립적인 수정이 가능)
	- 각 Protocol 내부를 블랙박스로 여길 수 있다 (내부 동작 원리에 대해 지식이 없더라도, Input을 넣었을 때 Output을 볼 수 있다)
- 프로토콜 레이어링의 원칙
	- 양방향성 (각 레이어별로 송/수신을 모두 다룰 수 있어야 함)
	- 두 객체 아래의 Layer가 동일하게 쌓여 있어야 함 (한 쪽의 Layer가 N개면 반대쪽도 N개)

## OSI 7계층
- 네트워크에서 통신이 일어나는 7단계의 과정
- 매우 잘 정의된 Protocol Layering으로, 국제표준화기구 (ISO) 에 의해 산업적 표준화 되었다
- 통신이 일어나는 과정을 단계별로 파악할 수 있기 때문에, 흐름을 알아보기가 쉬워짐
- 또한 문제가 발생했을 때 어느 계층에서 문제가 일어났는지 빠르게 파악이 가능하기 때문
- 모든 계층이 독립적으로 운용되기 때문에, 한 계층에서의 수정이 다른 계층에 대해서까지 영향을 미치는 것을 방지할 수 있다
- 상위 계층 (5~7계층) 은 데이터 생성을 담당하고, 소프트웨어 위주이다
- 하위 계층 (1~4계층) 은 데이터 전송을 담당하고, 하드웨어 위주이다

### 1계층 : 물리계층 (Physical Layer)
- 전기적, 기계적, 기능적 특성을 이용해서 통신 케이블로 데이터 전송
- 통신 단위는 비트이며, 데이터를 전송만 할 뿐 데이터의 내용물과 에러 여부에는 관심이 없다
- 데이터 링크 계층으로부터 받은 Frame을 실제 비트로 해석할 수 있도록 비트스트림으로 만드는 역할을 수행한다
- 이때 처리하는 단위는 Electrical Signal, Light Signal 등 시그널
	- 시그널은 시간에 따른 전기의 흐름을 표기하는 것
	- AC, DC, Sin, Cos 신호 등
	- 물리계층에선 이러한 흐름에 비트를 실어 물리적인 통신을 진행
- 물리계층에 속하는 장비로는 통신 케이블, 리피터, 허브 등이 있음
- 쉽게 말해서 실질적인 하드웨어 부분이라고 생각하면 됨

### 2계층 : 데이터 링크 계층 (Data Link Layer)
- 비트 데이터, 혹은 패킷 (Packet) 을 프레임화하여 기기 간 (물리적인 네트워크 사이에서) 전달
	- 패킷은 컴퓨터에서 데이터를 주고받을 때 정해둔 데이터 형식 (Pack + Bucket)
	- 큰 신호를 적당한 크기로 나누어 전송할 위치 등을 담아 특정한 형태로 전송
	- 택배라고 생각하면 됨
- Hop-to-Hop 방식으로 전달
	- 서로 속한 네트워크가 같으면서 인접한 기기 (Adjacent Node) 에 데이터 전달
	- 이때 맥 주소를 이용하여, 물리계층에서 받은 정보 전달
- 맥 (MAC) 주소란
	- Media Access Control 주소
	- 각 기기의 네트워크 카드 (하드웨어) 에 부여된 고유한 물리적 주소
	- 모든 네트워크 장비는 자신만의 고유한 MAC 주소를 가지고 있다
	- 48비트로 구성되어 있으며, 16진수로 표시됨
	- ifconfig / ipconfig로 확인 (Piscine 때 해봤지요?)
- 물리 계층에서 신경쓰지 않았던 정보의 에러 여부나 흐름 등을 관리하여 안전한 정보 전달을 목표로 함
	- 만약 데이터에 오류가 났을 경우 재전송하거나, 오류를 수정하는 등의 수단을 제공한다
	- Hop-to-Hop 방식으로 전송된 데이터는 에러가 없도록 전달되기 때문에, 상위 레이어에서는 Error free (에러 없음) 으로 가정하고 데이터를 송수신받을 수 있다
	- Error Detection만 가능해도 에러 수정이 가능하므로 Error free로 침
- 데이터 링크계층에 해당하는 장비로는 네트워크 브릿지나 스위치 등이 있다

### 3계층 : 네트워크 계층 (Network Layer)
- 데이터 (패킷 단위) 를 목적지까지 가장 안전하고 빠르게 전달하는 것을 목표로 한다
	- 이것을 위해 다양한 종류의 프로토콜과 라우팅 기술을 사용
- 해당 계층에서, 경로와 주소를 결정하고 경로에 따라 패킷을 전달해준다
	- 경로 선택 : Routing
	- 주소 부여 : IP
- 라우팅이란
	- 하나의 컴퓨터에서부터, 자신이 속하지 않은 네트워크에 속한 컴퓨터에 통신할 때 발생된 패킷을 목적지까지 전달해주는 과정
	- 이때 상호작용 가능한 네트워크를 구성하기 위해 독립적으로 운영되는 네트워크를 묶게 되면, 데이터의 출발 지점 (Source) 부터 도착 지점 (Destination) 까지 여러 개의 경로가 생긴다
	- 이러한 경로 중 가장 최적의 경로를 찾아내는 기능을 Routing이라 함
- Internetworking이란
	- 인터페이스 간의 패킷 송수신
	- 종단간 패킷 송수신이 아니더라도, 그 중간 지점의 게이트웨이 또는 라우터 간 패킷 송수신이 해당
- IP란
	- Connectionless하며, 단순히 Destination을 찾아가기 위한 용도의 Internetworking 서비스
	- 종단간 Reliable delivery를 보장하진 않지만, 최대한 보장해주고자 노력한다 (Best effort delivery)
	- [IP 주소?](1_IP.md)
- 전송 계층 (4계층) 에서 요구하는 서비스 품질을 만족시키기 위한 수단을 제공
- 라우팅, 흐름 제어, 세그멘테이션, 오류 제어, 인터네트워킹 등의 동작 수행
- 데이터를 연결된 다른 네트워크에 전달함으로써 인터넷이 가능하게 만들어준다


### 4계층 : 전송 계층 (Transport Layer)
- 통신을 활성화하기 위한 계층 (Error detection / correction 등)
- Network Layer가 호스트들 간의 논리적 통신을 돕는다면, Transport Layer은 응용 프로세스간 논리적 통신을 돕는다
	- 네트워크 계층까지의 하위 계층 (1~3계층) 은 하드웨어적인 통신을 주로 다룸
	- 전송 계층부터의 상위 계층 (4~7계층) 은 소프트웨어적인 통신을 주로 다룸
- TCP / UDP 프로토콜을 사용
	- 주로 TCP 프로토콜을 이용하며, 포트를 열어서 응용 프로그램들이 데이터를 전송할 수 있게 돕는다
- 하위 계층 및 상위 계층에서 사용하는 제어 방법 및 내용에 관계없이 정보가 3~5계층 사이에서 내용이 바뀜 없이 투명하게 전송하도록 도움
	- 이처럼 전송 계층에서 사용자들이 신뢰성 있는 데이터를 주고받을 수 있도록 도와주기 때문에, 상위 계층에서는 데이터 전달의 유효성이나 효율성을 생각치 않아도 된다
- 데이터를 수신받을 때는, 해당 계층에서 데이터를 합친 후 5계층에 넘겨준다
- 전송 계층은 특정 연결의 유효성을 제어하고, 일부 프로토콜에서 상태 개념을 사용하며, 연결 기반으로 작동한다
	- 연결 기반이라는 것은 전송 계층이 패킷들의 전송의 유효성을 체크하고, 유효하지 않은 (전송 실패한) 패킷을 재전송한다는 뜻
- 종단간 (end to end) 통신을 다루는 최하위 계층으로 종단간 신뢰성 있고 효율적인 데이터를 전송하며, 오류검출 및 데이터 복구, 흐름 제어, 중복 검사 등을 수행
- [TCP / UDP 프로토콜](3_TCPUDP.md)

### 5계층 : 세션 계층 (Session Layer)
- 데이터가 통신하기 위한 논리적인 연결
	- 통신을 하기 위한 대문
- 세션 계층부터는 응용 프로그램 관점에서 봐야 함
	- TCP/IP 세션 설정, 유지, 종료, 전송 중단 시 복구 등의 기능 수행
		- 세션을 엶으로써 정해진 시간동안 데이터 송수신을 가능케 해준다
	- 종단간 응용 프로세스가 통신을 관리할 수 있도록 수단을 제공
		- 동시 송수신 방식 (Duplex), 반이중 방식 (Half - Duplex), 전이중 방식 (Full Duplex), 체크포인팅과 유휴, 종료, 다시 시작 과정 등을 수행
		- 종단간 메시지 송수신을 진행하면서 Dialog control (Endpoint와 Token을 이용해 누가 전송받고 수신받을 차례인지에 대한 순서 조정 및 관리) 와 Synchronization (Stream으로 들어오는 데이터에 대하여 동기화 지점을 기록) 가 가능하게 도와주기 때문
- 세션 계층은 여러 경우들이 존재
	- 세션 계층 하나당 한 개의 전송 계층
	- 세션 계층 여러 개에 한 개의 전송 계층 공유
	- 세션 계층 한 개에 여러 개의 전송 계층이 공유 (가장 일반적)

### 6계층 : 표현 계층 (Presentation Layer)
- 데이터 표현이 상이한 응용 프로세스의 독립성을 제공하고 암호화
- 코드 간의 번역을 담당하며, 각 시스템별 데이터 형식 차이를 응용 프로그램 전에 보정해준다
	- 예를 들면 EBCDIC, ANSI 등으로 인코딩된 파일을 ASCII로 인코딩된 파일로 변환하는 등
	- 해당 데이터가 Text인지, 그림인지, 음악인지 등을 구분하는 것도 해당 계층의 몫
	- 결국 사용자의 명령어를 완성하고 결과를 표현 / 포장 / 압축 / 암호화하는 역할 수행
		- 송신 시에 Encoding (암호화) 및 Compressing (압축) 을 수행했다면
		- 수신 시에 Decoding (해독) 및 Decompressing (압축 해제) 을 수행한다
	- Network Format <-> Application Format

### 7계층 : 응용 계층 (Application Layer)
- 최종 목적지
- HTTP, FTP, SMTP, POP3, IMAP, Telnet 등의 프로토콜이 있다
	- HTTP : 웹 상에서 웹서버 및 웹브라우저 상호간의 데이터 전송을 위한 응용 계층의 프로토콜
		- www 상의 이미지, 비디오, 음성 등 거의 모든 형식의 데이터를 주고받을 수 있다
		- 전송계층에서는 TCP를 사용하고, 포트 번호는 80번이다
- 앞에서 송수신된 패킷들은 해당 프로토콜들에 의해 적절히 처리되며, 실제 응용 프로그램들은 이러한 프로토콜을 사용자가 쉽게 사용할 수 있도록 돕는다
	- 이러한 응용 프로그램들 덕분에 사용자와 직접 상호작용하는 레이어로, 사용자에게 보여진다
