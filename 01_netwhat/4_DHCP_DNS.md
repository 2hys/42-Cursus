# netwhat

## DHCP
- Dynamic Host Configuration Protocol
- IP 주소와 같은 TCP/IP 통신을 수행하기 위한 네트워크 구성 패러미터들을 동적으로 설정하기 위해 사용되는 표준 네트워크 프로토콜 (Application Layer에서 동작)
- 네트워크 관리자는 ISP로부터 할당받은 주소 블록 내에서 호스트들에게 IP 주소를 할당하고 관리해줘야 한다
	- 이를 위해 수많은 호스트들에게 IP를 할당하고, 호스트 이동 시 새로운 주소를 설정해 주어야 하는데, 수동으로 하기엔 너무나도 귀찮고 번거로운 작업
	- DHCP를 이용하면 이것을 모두 자동으로 관리할 수 있다
	- 호텔 체크인 / 체크아웃을 자동화한 느낌?
- DHCP는 호스트가 네트워크에 접속하고자 할 때마다 IP를 동적으로 할당받을 수 있도록 해줌
	- 따라서 호스트가 빈번하게 접속을 연결 및 갱신하는 가정용 인터넷 접속 네트워크 및 무선 랜 (LAN) 에서 폭넓게 사용됨
- UDP 패킷을 이용하는 비연결형 서비스 모델을 기반으로 함 (신뢰성 보장 X)
- DHCP를 통한 연결 과정
	1. DHCP 서버 발견
		- 새롭게 도착한 호스트는 자신이 접속할 네트워크의 DHCP 서버 주소를 알지 못하므로, DHCP 서버 발견 메시지를 브로드캐스트 IP 주소 (255.255.255.255) 로 캡슐화하여 서브넷 상 모든 노드로 전송한다
	2. DHCP 서버 제공
		- DHCP 발견 메시지를 받은 DHCP 서버는 DHCP 제공 메시지를 이용해 클라이언트로 브로드캐스트한다
		- 아직 송신 호스트의 IP주소가 할당되지 않았기 때문에, 서브넷 상의 모든 호스트로 브로드캐스트하여 응답하는 것
		- DHCP 서버 제공 메시지는 클라이언트에 제공될 IP주소 네트워크 마스크, 도메인 이름, IP주소 임대 기간 (유효시간) 등의 클라이언트 설정 패러미터 값을 포함한다
	3. DHCP 요청
		- IP할당을 요청했던 호스트는 하나 이상의 DHCP 서버 제공 메시지를 받고, 그 중 가장 최적의 서버를 선택하여 DHCP 요청 메시지를 보낸다
	4. DHCP ACK (Acknowledgement)
		- 서버는 DHCP 요청 메시지에 대해 요청된 설정을 확인하는 ACK 메시지를 전송함으로써, 호스트가 서버에 연결된다
- DHCP가 지원하는 기능
	1. Automatic Allocation
		- Client (호스트) 에게 영구적인 IP 주소 할당
	2. Dynamic Allocation
		- Client에게 제한된 기간동안만 살아 있는 Non-permanent IP 주소 할당
	3. Manual Allocation
		- Client의 IP주소를 네트워크 관리자로부터 직접 할당
		- 이때 DHCP는 네트워크 관리자로부터 받은 IP 주소를 나르는 용도로만 사용
- DHCP는 IPv4, IPv6 둘 다 지원한다

## DNS
- Domain Name Service
- 모든 네트워크는 IP를 통해 이루어지기 때문에, 웹사이트에 접속하기 위해서도 IP 주소를 입력해야 함
- 하지만 IP 주소를 외우는 건 너무 헷갈리고 복잡하다
- DNS는 전화번호부 같은 것으로, 문자로 된 주소를 IP 주소로 변환하여 접속 가능하게 연결해 준다
- DNS 서버 동작 과정
	1. PC는 사용자로부터 입력받은 주소를 토대로 DNS 서버에게 IP를 물어봄
	2. 로컬 서버가 정보를 가지고 있다면 바로 응답을 제공
		- 없다면 로컬 서버가 Root DNS 서버에 정보를 물어봄
	3. Root DNS 서버는 해당 주소에 대한 정보를 관리하는 COM DNS 서버의 정보를 알려줌
		- 루트 DNS 서버는 최상위 네임 서버들의 서버명과 IP주소를 가지고 있음 (글루레코드)
		- 이 글루레코드를 토대로 COM 네임서버를 참조하라고 응답함
	4. 로컬 서버는 해당 COM DNS 서버에게 정보를 물어보고, COM DNS 서버는 주소에 대한 서버 정보를 알려줌
		- COM 네임서버는 .com으로 끝나는 (.com을 최상위 도메인으로 사용하는) 도메인들의 글루레코드를 가지고 있음
		- 따라서 naver.com 이나 yahoo.com 등은 COM 네임서버의 하위 네임서버에 포함되어 있다
	5. 로컬 서버는 해당 서버에게 IP 주소를 물어보고, 주소에 대한 서버가 주소 접근을 위한 IP 정보를 알려줌
		- 주소에 해당하는 네임서버는 도메인에 대한 zone 파일을 참고하여 IP주소를 로컬 네임서버에거 전달
		- 주소에 해당하는 네임서버란, naver.com 이면 네이버 네임서버, yahoo.com이면 야후 네임서버 등
	6. IP 정보를 받은 로컬 서버는 PC에게 IP 정보를 응답해주고, 이것을 토대로 웹사이트 접근
- 한 번 검색한 결과는 메모리의 캐시에 기록해두며, 같은 정보가 요청되면 굳이 한번 더 DNS 서버를 동작시키지 않고 캐시에 있는 정보를 바로 전달한다
	- 이러한 캐시 데이터는 유효기간이 있기 때문에, 유효기간이 지나면 날아감

## Routing
- 한 네트워크에서 다른 네트워크로 이동하기 위한 경로 설정
	- 여러 갈래 길 중 가장 빠르고 정확한 길을 찾아 알려주는 것이 routing의 핵심 내용
	- 맛집을 찾아갈 때
		1. 맛집의 주소를 확인
		2. 맛집이 있는 동네로 가기 위해 가장 편하고 빠른 교통수단과 경로 확인
		3. 선택한 교통수단을 이용하여 해당 경로를 통해 맛집으로 출발
	- 라우팅 또한
		1. IP 주소 (목적지) 확인
		2. 해당 IP 주소로 접근하기 위해 가장 빠른 경로와 인터페이스 확인
		3. 결정한 인터페이스로 패킷을 전달
		4. 패킷은 또다른 라우터에 도착하며, 목적지에 도착할 때까지 위의 1 ~ 3 반복
- 라우팅을 위해 필요한 것
	- 출발지와 목적지의 네트워크 정보
	- 목적지로 가는 모든 경로 (최적의 경로 찾기 위함)
	- 최적의 경로 (목적지로 가는 모든 경로 중 하나를 선택)
		- 이 경로를 저장하는 곳을 Routing Table이라 하며, L3 장비가 이 테이블 정보를 이용하여 패킷을 전달
	- 지속적인 네트워크 상태 확인
		- 지정한 경로가 Down되어 있는 상태라 사용불가능할 때를 대비
		- Routing table에 저장된 경로가 전달 가능한 상태인지 지속적으로 체크가 필요
- 라우터의 역할
	- 전달받은 패킷의 목적지 주소를 자신의 Routing Table과 비교하여, 어느 라우터에게 넘겨줘야 최적일지 판단
- 라우팅 종류
	- Connected : 자신과 물리적으로 직접 연결되어 있는 네트워크의 주소를 학습해온 경우
	- Static : 관리자가 수동으로 입력한 목적지 정보
	- Dynamic : Routing Protocol을 이용하여 동적으로 알아온 목적지의 정보
	- Redistribution : 재분배, 서로 다른 라우팅 프로토콜 간의 정보 교환에 사용

### 정적 라우팅 (Static Routing)
- 네트워크 관리자가 패킷의 경로를 수동으로 구성함
- 네트워크 환경 변화와 무관하게 항상 같은 경로로만 패킷 라우팅 경로를 설정하고, 유지한다
- 맛집을 찾아가기 위해서 무조건 3호선을 타고 가야만 한다! 라고 정해주는 것
- 장점
	- 관리자의 의도대로 제어가 가능
	- 경로 정보를 주고받을 필요가 없어 효율 상승
- 단점
	- 경로를 설정하고 유지하는 데에 관리자의 노력이 필요하다
	- 적절한 경로 구현을 위해 관리자의 이해도가 높아야 함
	- 네트워크 규모가 커지면 힘듦

### 동적 라우팅 (Dynamic Routing)
- 인접한 라우터들 사이에서 라우팅 프로토콜을 이용하여 네트워크 정보를 상호 교환
- 라우팅 테이블을 매번 자동적으로 생성하고, 유지함
- 맛집을 찾아가기 위해 그때그때 교통 상황마다 서로 다른 길을 찾아가는 것
- 장점
	- 관리자가 작업해야 할 분량이 적다
	- 경로의 특성에 대한 정보를 주고받고, 상황에 따라 적합한 경로를 선택할 수 있음
- 단점
	- CPU, 메모리, 링크 대역폭 등의 자원이 필요
	- 여러 정보를 가지게 되므로, 데이터 전송 속도가 느려짐

## Gateway
- 현재 사용자가 위치한 네트워크에서 다른 네트워크로 이동하기 위해 반드시 거쳐야 하는 거점 (톨게이트)
- 두 컴퓨터가 네트워크 상에서 서로 연결되려면 동일한 통신 프로토콜을 사용해야 하는데, 만약 프로토콜이 서로 다를 경우 이 프로토콜을 서로 변환해 주는 변환기가 필요
	- 게이트웨이가 이런 프로토콜 변환기 역할을 함 (통역사와 비슷)
- 하드웨어 형태로, 라우터의 상위 개념이라고 생각할 수 있다
	- 라우터도 한 네트워크에서 다른 네트워크로 이동시켜주는 역할을 하므로
	- 게이트웨이를 지날 때마다 네트워크 부하가 상승해, 전송 속도가 느려질 수 있다
- 인터넷을 하려면 필수적임 (로컬 네트워크가 아닌 다른 네트워크로 이동하기 때문)
- 게이트웨이의 IP 주소는 현재 네트워크 내 컴퓨터에 할당된 IP 주소 중 맨 끝 옥텟만 다른 형태
	- 보통 abc.def.ghi.1 과 같이 1을 설정해줌
	- 게이트웨이 IP 설정이 잘못되면 인터넷 연결이 불가능

### Default Gateway
- 내부 네트워크끼리는 라우터 없이도 통신이 가능하므로, (같은 브로드캐스트 도메인끼리는 라우터 없이 통신 가능) 통신 시 목적지를 찾기 위해 내부 네트워크를 먼저 탐색함
- 이때 내부 네트워크에 목적지가 없을 경우, 기본 게이트웨이를 통해 외부 네트워크로 나가서 목적지를 찾는다
- 라우터는 인터페이스별로 IP를 각각 배정하고, 스위치나 허브는 장비별로 하나씩 배정함
